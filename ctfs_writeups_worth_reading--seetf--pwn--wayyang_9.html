<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>wayyang</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>wayyang</h1><br/><p></p><p>PYTHON SANDBOX EXPLOIT</p><p></p><p>FOR MORE SUCH EXPLOITS REFER:<a href="https://book.hacktricks.xyz/generic-methodologies-and-resources/python/bypass-python-sandboxes">https://book.hacktricks.xyz/generic-methodologies-and-resources/python/bypass-python-sandboxes</a></p><p></p><p></p><p>so this was one of the good question relating python</p><p>if you look at the source code :</p><p>#!/usr/local/bin/python</p><p>import os</p><p></p><p><span style="text-decoration:underline;">FLAG_FILE = &quot;FLAG&quot;</span></p><p><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;">def get_input() -&gt; int:</span></p><p><span style="text-decoration:underline;">    print(&#39;&#39;&#39;                 ,#####,</span></p><p><span style="text-decoration:underline;">                 #_   _#</span></p><p><span style="text-decoration:underline;">                 |a` `a|</span></p><p><span style="text-decoration:underline;">                 |  u  |            ________________________</span></p><p><span style="text-decoration:underline;">                 \  =  /           |        WAYYANG         |</span></p><p><span style="text-decoration:underline;">                 |\___/|           &lt;     TERMINAL  v1.0     |</span></p><p><span style="text-decoration:underline;">        ___ ____/:     :\____ ___  |________________________|</span></p><p><span style="text-decoration:underline;">      .&#39;   `.-===-\   /-===-.`   &#39;.</span></p><p><span style="text-decoration:underline;">     /      .-&quot;&quot;&quot;&quot;&quot;-.-&quot;&quot;&quot;&quot;&quot;-.      \</span></p><p><span style="text-decoration:underline;">    /&#39;             =:=             &#39;\</span></p><p><span style="text-decoration:underline;">  .&#39;  &#39; .:    o   -=:=-   o    :. &#39;  `.</span></p><p><span style="text-decoration:underline;">  (.&#39;   /&#39;. &#39;-.....-&#39;-.....-&#39; .&#39;\   &#39;.)</span></p><p><span style="text-decoration:underline;">  /&#39; ._/   &quot;.     --:--     .&quot;   \_. &#39;\</span></p><p><span style="text-decoration:underline;"> |  .&#39;|      &quot;.  ---:---  .&quot;      |&#39;.  |</span></p><p><span style="text-decoration:underline;"> |  : |       |  ---:---  |       | :  |</span></p><p><span style="text-decoration:underline;">  \ : |       |_____._____|       | : /</span></p><p><span style="text-decoration:underline;">  /   (       |----|------|       )   \</span></p><p><span style="text-decoration:underline;"> /... .|      |    |      |      |. ...\</span></p><p><span style="text-decoration:underline;">|::::/&#39;&#39; jgs /     |       \     &#39;&#39;\::::|</span></p><p><span style="text-decoration:underline;">&#39;&quot;&quot;&quot;&quot;       /&#39;    .L_      `\       &quot;&quot;&quot;&quot;&#39;</span></p><p><span style="text-decoration:underline;">           /&#39;-.,__/` `\__..-&#39;\</span></p><p><span style="text-decoration:underline;">          ;      /     \      ;</span></p><p><span style="text-decoration:underline;">          :     /       \     |</span></p><p><span style="text-decoration:underline;">          |    /         \.   |</span></p><p><span style="text-decoration:underline;">          |`../           |  ,/</span></p><p><span style="text-decoration:underline;">          ( _ )           |  _)</span></p><p><span style="text-decoration:underline;">          |   |           |   |</span></p><p><span style="text-decoration:underline;">          |___|           \___|</span></p><p><span style="text-decoration:underline;">          :===|            |==|</span></p><p><span style="text-decoration:underline;">           \  /            |__|</span></p><p><span style="text-decoration:underline;">           /\/\           /&quot;&quot;&quot;`8.__</span></p><p><span style="text-decoration:underline;">           |oo|           \__.//___)</span></p><p><span style="text-decoration:underline;">           |==|</span></p><p><span style="text-decoration:underline;">           \__/&#39;&#39;&#39;)</span></p><p><span style="text-decoration:underline;">    print(&quot;What would you like to do today?&quot;)</span></p><p><span style="text-decoration:underline;">    print(&quot;1. Weather&quot;)</span></p><p><span style="text-decoration:underline;">    print(&quot;2. Time&quot;)</span></p><p><span style="text-decoration:underline;">    print(&quot;3. Tiktok of the day&quot;)</span></p><p><span style="text-decoration:underline;">    print(&quot;4. Read straits times&quot;)</span></p><p><span style="text-decoration:underline;">    print(&quot;5. Get flag&quot;)</span></p><p><span style="text-decoration:underline;">    print(&quot;6. Exit&quot;)</span></p><p><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;">    choice = int(input(&quot;&gt;&gt; &quot;))</span></p><p><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;">    return choice</span></p><p><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;">if __name__ == &#39;__main__&#39;:</span></p><p><span style="text-decoration:underline;">    choice = get_input()</span></p><p><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;">    if choice == 1:</span></p><p><span style="text-decoration:underline;">        print(&quot;CLEAR SKIES FOR HANDSOME MEN&quot;)</span></p><p><span style="text-decoration:underline;">    elif choice == 2:</span></p><p><span style="text-decoration:underline;">        print(&quot;IT&#39;S ALWAYS SEXY TIME&quot;)</span></p><p><span style="text-decoration:underline;">    elif choice == 3:</span></p><p><span style="text-decoration:underline;">        print(&quot;</span><a href="https://www.tiktok.com/@benawad/video/7039054021797252399")">https://www.tiktok.com/@benawad/video/7039054021797252399&quot;)</a><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;">    elif choice == 4:</span></p><p><span style="text-decoration:underline;">        filename = input(&quot;which news article you want babe :)   &quot;)</span></p><p><span style="text-decoration:underline;">        not_allowed = [char for char in FLAG_FILE]</span></p><p><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;">        for char in filename:</span></p><p><span style="text-decoration:underline;">            if char in not_allowed:</span></p><p><span style="text-decoration:underline;">                print(&quot;NICE TRY. WAYYANG SEE YOU!!!!!&quot;)</span></p><p><span style="text-decoration:underline;">                os.system(f&quot;cat news.txt&quot;)</span></p><p><span style="text-decoration:underline;">                exit()</span></p><p><span style="text-decoration:underline;"></span></p><p><span style="text-decoration:underline;">        try:</span></p><p><span style="text-decoration:underline;">         </span><strong><span style="text-decoration:underline;">   os.system(f&quot;cat {eval(filename)}&quot;)</span></strong><span style="text-decoration:underline;">  ##this line##</span></p><p><span style="text-decoration:underline;">        except:</span></p><p><span style="text-decoration:underline;">            pass</span></p><p><span style="text-decoration:underline;">    elif choice == 5:</span></p><p><span style="text-decoration:underline;">        print(&quot;NOT READY YET. MAYBE AFTER CTF????&quot;)</span></p><p>        </p><p></p><p>look at “this line” when we choose 4 option anf don&#39;t give the filename as the characters in the array not_allowed i.e = [F L A G]</p><p></p><p>we get to evaluate a “filename” variable in the try section, thus this is the loophole of eval function we can a python sandbox code there as it acts as a sandbox,</p><p>this by giving the filename as : __import__(&#39;os&#39;).system(&#39;ls&#39;)</p><p></p><p>we get list of all files and thus run the command:</p><p>__import__(&#39;os&#39;).system(&#39;cat \x46\x4c\x41\x47&#39;)</p><p>this FLAG name is is converted to hexadecimal value as linux uses UTF-8 encoding to encode filenames with delimiter as /x</p></div>
</body>
</html>
