<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Authentication bypass via OAuth implicit flow</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>Authentication bypass via OAuth implicit flow</h1><br/><p>so this is a basic lab where the main goal is to login into the other user account with email: <h3>carlos@carlos-montoya.net</h3></p><p>and as common sense says : username will be carlos , </p><p></p><p>we also are give our credentials for session and authorization code generation and login</p><p></p><p>now you get the crux of the problem , due to the flawed validation system  we can use our own credentials from the site and use it to login our account but that&#39;s not all , duing the OAUTH steps :</p><p><a href="https://portswigger.net/web-security/images/oauth-authorization-code-flow.jpg"><img src="images/67-1.png" alt="images/67-1.png" /></a></p><p></p><p>we&#39;ll go as the flow goes till the step 5 where the access token is granted on our name and credentials , now we need to stay alert after step 5</p><p>as during step 7 when client get the credentials , and those are being given what we&#39;ll do is we&#39;ll intercept the request and provide the creds we were told to hack and paste them in the section: </p><p></p><p>before :                                                                                                       AFTER:</p><p><img src="images/67-2.png" alt="images/67-2.png" />  <img src="images/67-3.png" alt="images/67-3.png" /></p><p></p><p></p><p>why does this happen: </p><p>Due to the dangers introduced by sending access tokens via the browser, the <a href="https://portswigger.net/web-security/oauth/grant-types#implicit-grant-type">implicit grant type</a> is mainly recommended for single-page applications. However, it is also often used in classic client-server web applications because of its relative simplicity.</p><p>In this flow, the access token is sent from the OAuth service to the client application via the user&#39;s browser as a <span style="color:#ffbe6f;">URL fragment</span>. The client application then accesses the token using <span style="color:#ffbe6f;">JavaScript</span>. The trouble is, if<span style="color:#ffbe6f;"> the application wants to maintain the session after the user closes the page, it needs to store the current user data (normally a user ID and the access token) somewhere.</span></p><p></p><p><span style="color:#237522;">To solve this problem, the client application will often submit this data to the server in a </span><code><span style="color:#237522;">POST</span></code><span style="color:#237522;"> request and then assign the user a session cookie, effectively logging them in. This request is roughly equivalent to the form submission request that might be sent as part of a classic, password-based login. However, in this scenario, the server does not have any secrets or passwords to compare with the submitted data, which means that it is implicitly trusted.</span></p><p></p><p>Attack:</p><p></p><p>In the implicit flow, this <code>POST</code> request is exposed to attackers via their browser. As a result, this behavior can lead to a serious vulnerability if the client application doesn&#39;t properly check that the access token matches the other data in the request. In this case, an attacker can simply change the parameters sent to the server to impersonate any user.</p><p></p></div>
</body>
</html>
