<!doctype html>
<html>
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>bottle-poems</title>
  <meta name="generator" content="CherryTree">
  <link rel="stylesheet" href="res/styles4.css" type="text/css" />
</head>
<body>
<div class='page'><h1 class='title'>bottle-poems</h1><br/><p>so there&#39;s this website with 3 poems on the website </p><p><img src="images/55-1.png" alt="images/55-1.png" />, the main motive was to see the flag that was being hidden inside a file on the server , but how to access the file?</p><p>the url was kind-of this:</p><p>    <a href="http://bottle-poem.ctf.sekai.team/show?id=spring.txt">http://bottle-poem.ctf.sekai.team/show?id=spring.txt</a></p><p>    </p><p>    <img src="images/55-2.png" alt="images/55-2.png" /></p><p>    </p><p>    so what if we do:</p><p>    <a href="http://bottle-poem.ctf.sekai.team/show?id=/etc/passwd">http://bottle-poem.ctf.sekai.team/show?id=/etc/passwd</a></p><p>    bingo it works:</p><p>    </p><p>    <img src="images/55-3.png" alt="images/55-3.png" /></p><p>    </p><p>    the hint said that the flag was executable so we checked the webserver&#39;s process:</p><p>    as in the hope that the flag was executed some time</p><p>    </p><p>    <code>curl http://bottle-poem.ctf.sekai.team/show?id=/proc/self/cmdline -o- | tr \\0 \\n</code></p><p>    /proc/self/cmdline - </p><p>     </p><p>     <a href="https://web.mit.edu/rhel-doc/5/RHEL-5-manual/Deployment_Guide-en-US/ch-proc.html">https://web.mit.edu/rhel-doc/5/RHEL-5-manual/Deployment_Guide-en-US/ch-proc.html</a><a href="https://web.mit.edu/rhel-doc/5/RHEL-5-manual/Deployment_Guide-en-US/ch-proc.html(read">   </a></p><p><a href="https://web.mit.edu/rhel-doc/5/RHEL-5-manual/Deployment_Guide-en-US/ch-proc.html(read">     (read</a> 2 pages atleast if reading)</p><p><span style="color:#237522;">     The /proc/ directory — also called     the proc file system —     contains a hierarchy of special files which represent the current     state of the kernel — allowing applications and users to     peer into the kernel&#39;s view of the system.   </span></p><p><span style="color:#237522;">           Within the /proc/ directory,     one can find a wealth of information detailing the system hardware     and any processes currently running. In addition, some of the     files within the /proc/     directory tree can be manipulated by users and applications to     communicate configuration changes to the kernel.   </span></p><p><span style="color:#237522;"></span>the proc directory contains many crucial files that have sensitive info regarding the cryptographic ciphers used by system , the processes , the cmdline arguments , as well as the cpu type and it&#39;s usage</p><p></p><p>to read specific process&#39;s data:</p><p>/proc/&lt;process&gt;/&lt;file&gt;</p><p></p><p>like in /proc/self/cmdline here we reading the <span style="color:#071ba3;">currently running process&#39;s</span>(self) cmdline</p><p></p><p>so we get the output:</p><p></p><p><code>python3</code></p><p><code> -u</code></p><p><code>/app/app.py</code></p><p></p><p>we fetch this file:</p><p><code>curl </code><code><a href="http://bottle-poem.ctf.sekai.team/show?id=/app/app.py">http://bottle-poem.ctf.sekai.team/show?id=/app/app.py</a></code></p><p></p><p>or just edit the url and check the network in the developer&#39;s menu in browser , double click the document and it&#39;ll open in the browser itself</p><p>        </p><p>        </p><p>        <img src="images/55-4.png" alt="images/55-4.png" /></p><p>this is the code</p><p>look at line 38 , the cookies are beig signed by the secret called “sekai” , we somehow need to find this or the admin cookie , so that we can either generate our own or steal the admin&#39;s</p><p></p><p></p><p>look at the line 32 we see that there&#39;s a hidden endpoint &quot;</p><p>sign&quot; when we go to the url :</p><p><a href="http://bottle-poem.ctf.sekai.team/sign">http://bottle-poem.ctf.sekai.team/sign</a> we&#39;ll be greeted as hello guest and when we go as admin , we get the flag , so what do we do?</p><p></p><p>we know that in python web-dev there&#39;s a folder app and that contains config , in that folder we got secret.py look at line 2 if wondering how we got this:</p><p>sekai = &quot;Se3333KKKKKKAAAAIIIIILLLLovVVVVV3333YYYYoooouuu&quot;</p><p></p><p>now we got the value that signs the cookie and we can escalate the privesc:</p><p>    </p></div>
</body>
</html>
